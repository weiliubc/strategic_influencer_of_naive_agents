A = [0.217	0.2022	0.2358	0.1256	0.1403;
	0.2497	0.0107	0.2334	0.1282	0.378;
	0.1285	0.0907	0.3185	0.2507	0.2116;
	0.1975	0.0629	0.2863	0.2396	0.2137;
	0.1256	0.0711	0.0253	0.2244	0.5536];

b = [0.0791;
	0;
	0;
	0;
	0];

c = [0 1 0 0 0];


% A = [0.3 0.2;
%      0.1 0.5];
% b = [0.3;
%      0.5]; 
% c = [0 1]; 


dim = size(A,1);



Q = eye(dim);
R = 0;
[K,L,G] = dare(A,b,Q,R);  %% A-bG







mu_x0 = 0; 
sigma_x0 = 100; 
P0 = (sigma_x0^2)*eye(dim);
% x0 = normrnd(mu_x0,sigma_x0,5,1);
x0 = [-27.7872;
	 70.1541;
	 -205.1816;
	 -35.3850;
	 -82.3587];
 
% x0 = [-144.909729283874;
%       33.3510833065806];



X = [x0]; 
Y = [];
Xi_i = []; 
P = P0;
U = [];
pred = zeros(dim,1);
Xiplus1_i = [];
 
 
 
for i = 1:10
    Y = [Y c*X(:,i)];
    Xi_i = [Xi_i pred+P*c'*(Y(i)-c*pred)/(c*P*c')]; 
    U = [U -G*Xi_i(:,i)];
    pred = A*Xi_i(:,i)+b*U(i);
    Xiplus1_i = [Xiplus1_i pred];
    X = [X A*X(:,i)+b*U(i)];
    P_temp = P - P*c'*c*P/(c*P*c');
    P = A*P_temp*A';
end






% 
% y0 = c*x0;
% x0_0 = P0*c'*(y0)/(c*P0*c'); 
% u0 = -G*x0_0;
% x1_0 = A*x0_0+b*u0;
% x1 = A*x0+b*u0;
% P0_0 = P0 - P0*c'*c*P0/(c*P0*c');
% P1_0 = A*P0_0*A';
% 
% 
% y1 = c*x1;
% x1_1 = x1_0+P1_0*c'*(y1-c*x1_0)/(c*P1_0*c'); 
% u1 = -G*x1_1;
% x2_1 = A*x1_1+b*u1;
% x2 = A*x1+b*u1;
% P1_1 = P1_0 - P1_0*c'*c*P1_0/(c*P1_0*c');
% P2_1 = A*P1_1*A';
% 
% 
% y2 = c*x2;
% x2_2 = x2_1+P2_1*c'*(y2-c*x2_1)/(c*P2_1*c'); 
% u2 = -G*x2_2;
% x3_2 = A*x2_2+b*u2;
% x3 = A*x2+b*u2;
% P2_2 = P2_1 - P2_1*c'*c*P2_1/(c*P2_1*c');
% P3_2 = A*P2_2*A';
% 
% 
% y3 = c*x3;
% x3_3 = x3_2+P3_2*c'*(y3-c*x3_2)/(c*P3_2*c'); 
% u3 = -G*x3_3;
% x4_3 = A*x3_3+b*u3;
% x4 = A*x3+b*u3;
% P3_3 = P3_2 - P3_2*c'*c*P3_2/(c*P3_2*c');
% P4_3 = A*P3_3*A';
% 
% 
% y4 = c*x4;
% x4_4 = x4_3+P4_3*c'*(y4-c*x4_3)/(c*P4_3*c'); 
% u4 = -G*x4_4;
% x5_4 = A*x4_4+b*u4;
% x5 = A*x4+b*u4;
% P4_4 = P4_3 - P4_3*c'*c*P4_3/(c*P4_3*c');
% P5_4 = A*P4_4*A';
% 
% 
% u5 = -G*x5;
% x6 = A*x5+b*u5;
% 
% 
% u6 = -G*x6;
% x7 = A*x6+b*u6;
% 
% 
% u7 = -G*x7;
% x8 = A*x7+b*u7;
% 
% 
% u8 = -G*x8;
% x9 = A*x8+b*u8;
% 
% 
% u9 = -G*x9;
% x10 = A*x9+b*u9;
% 
% 
% u10 = -G*x10;
% x11 = A*x10+b*u10;
% 
% 
% u10 = -G*x10;
% x11 = A*x10+b*u10;






 





